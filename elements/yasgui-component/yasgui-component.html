<link rel="import" href="yasgui-theme.html">
<dom-module id="yasgui-component">
  <script type="text/javascript" src="yasgui.min.js"></script>

  <template>
    <style include="yasgui-theme"></style>
    <div id="showcase"></div>
  </template>

  <script>
    Polymer({
      is: "yasgui-component",

      properties: {

        endPoint: {
          type: String,
          notify: true,
          value :"",
          observer: "_endPointChanged"
        },

        _yasqe: {
          type: Object,
          notify: true,
          value: null
        },

        _yasr: {
          type: Object,
          notify: true,
          value: null
        },

        _query: {
          type: String,
          notify: true,
          value: ""
        }

      },

      ready: function() {
        this.set('_yasqe', new YASGUI.YASQE() );
        this.set('_yasr', new YASGUI.YASR( this.$.showcase ) );
      },

      refresh: function( query ) {

        console.log(query);

        var query = query || this._query;
        this._yasqe.setValue( query );
        this._yasqe.query( this._drawResponse.bind(this) )

      },

      _drawResponse: function( response ){

        console.log( response );

        var response = response || this._response;

        this._yasr.setResponse(response);
        this._yasr.draw();

      },

      _endPointChanged: function(){
        if(this.endPoint !== "")
          this._yasqe.options.sparql.endpoint = this.endPoint;
      }

    });
  </script>

</dom-module>
